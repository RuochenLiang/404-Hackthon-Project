<!DOCTYPE html>
<html>
  <body>
    <h2>Arduino Console Output</h2>
    <button id="connect">Connect to Board</button>
    <div id="status" style="color: green; font-weight: bold; margin-top: 10px;"></div>
    <pre id="log"></pre>

    <script>
      const log = document.getElementById("log");
      const status = document.getElementById("status");

      document.getElementById("connect").onclick = async () => {
        try {
          // select a serial device
          const port = await navigator.serial.requestPort();
          await port.open({ baudRate: 115200 });

          // Show success message
          status.textContent = "Connected successfully!";

          const decoder = new TextDecoder();
          const reader = port.readable.getReader();
          let buffer = "";

          while (true) {
            const { value, done } = await reader.read();
            if (done) break;
            buffer += decoder.decode(value);
            let lines = buffer.split("\n");
            buffer = lines.pop();
            for (const line of lines) {
              log.textContent += line.trim() + "\n";
            }
          }
        } catch (err) {
          console.error("Error:", err);
          status.textContent = "Connection failed!";
          status.style.color = "red";
        }
      };
    </script>
  </body>
</html>
